---
title: "Untitled"
author: "LL"
date: "9/3/2021"
output:
  word_document: default
  pdf_document: default
  html_document: default
---
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(flextable)
library(tidyverse)
set_flextable_defaults(font.family = "Times New Roman", font.size = 12)
setwd("/data/pt_life/ResearchProjects/LLammer/Results_blcs")
overview <- read.csv("overview.csv")
overview$dv <- as.character(overview$dv)
overview$predictor <- as.character(overview$predictor)
overview <- overview %>%
  mutate(dv = case_when(
    dv == "dHCV1" ~ paste0("\U0394", "HCV"),
    dv == "dLSNS1" ~ paste0("\U0394", "LSNS"),
    dv == "dexfunct1" ~ paste0("\U0394", "EF"),
    dv == "dmemo1" ~ paste0("\U0394", "Memo"),
    dv == "dprocspeed1" ~ paste0("\U0394", "PS"),
    TRUE ~ dv
  ), predictor = case_when(
    predictor == "LSNS_sum.0" ~ "LSNS_base",
    predictor == "HCV.0" ~ "HCV_base",
    predictor == "exfunct.0" ~ "EF_base",
    predictor == "memo.0" ~ "Memo_base",
    predictor == "procspeed.0" ~ "PS_base",
    TRUE ~ predictor
  )) 

overview[,c("estimate", "se", "p.value", "sided_p.value", "q_value")] <- round(overview[,c("estimate", "se", "p.value", "sided_p.value", "q_value")],digits = 3)
overview <- overview %>%
  mutate(p = case_when(
    sided_p.value < 0.05 ~ paste0(sided_p.value, "*"),
    TRUE ~ as.character(sided_p.value)
  ))
overview <- overview[,c("dv", "predictor", "estimate", "se", "p", "q_value")]
flextable(overview) %>%
  theme_vanilla() %>%
  set_header_labels(p = "p-value", q_value = "q-value") %>%
  add_footer_lines(values = c("dv, dependent variable; se, standard error; _base, baseline score of; \U0394, change in; LSNS, Lubben Social Network Score; HCV, hippocampal volume; EF, executive functions; Memo, memory; PS, processing speed",
                              "Only baseline social isolation significantly predicts change in executive functions. The p-value of 0.019 does not survive any multiplicity control, though.")) %>%
  add_header_row(values = "Relevant Regressions of Bivariate Latent Change Score Models", colwidths = 6) %>%
  fontsize(i = 1, j = NULL, size = 11, part = "header") %>%
  add_footer_row(values = c("* p<0.05"), colwidths = 6) 

```

